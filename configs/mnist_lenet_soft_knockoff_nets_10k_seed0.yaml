run:
  name: mnist_lenet_soft_knockoff_nets_10k_seed0
  seeds: [0]
  device: cuda:0

victim:
  victim_id: mnist28_lenet_mnist_sgd_seed0
  checkpoint_ref: runs/victims/mnist28_lenet_mnist_sgd_seed0.pt
  arch: lenet_mnist
  channels: 1
  num_classes: 10
  input_size: [28, 28]
  normalization:
    mean: [0.1307]
    std: [0.3081]
  output_mode: soft_prob
  temperature: 1.0
  output_modes_supported: ["soft_prob", "hard_top1"]

dataset:
  name: MNIST
  data_mode: surrogate
  surrogate_name: FashionMNIST
  train_split: true

substitute:
  arch: lenet_mnist
  init_seed: 1234
  trackA:
    batch_size: 128
    steps_coeff_c: 0.2
  optimizer:
    name: sgd
    lr: 0.01
    momentum: 0.9
    weight_decay: 5e-4
  loss:
    soft: kl
    hard: ce
  max_epochs: 1000
  patience: 100

attack:
  name: knockoff_nets
  output_mode: soft_prob
  # Knockoff params
  train_every: 1000
  train_epochs: 10
  samples_per_class: 50
  coarse_clusters: 10
  feature_arch: resnet18

budget:
  max_budget: 10000
  checkpoints: [1000, 10000]

cache:
  enabled: true
  policy: temporary
  delete_on_finish: true
