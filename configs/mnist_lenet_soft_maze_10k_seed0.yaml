run:
  name: mnist_lenet_soft_maze_10k_seed0
  seeds: [0]
  device: cuda:0

victim:
  victim_id: mnist28_lenet_mnist_sgd_seed0
  checkpoint_ref: runs/victims/mnist28_lenet_mnist_sgd_seed0.pt
  arch: lenet_mnist
  channels: 1
  num_classes: 10
  input_size: [28, 28]
  normalization:
    mean: [0.1307]
    std: [0.3081]
  output_mode: soft_prob
  temperature: 1.0
  output_modes_supported: ["soft_prob", "hard_top1"]

dataset:
  name: MNIST
  data_mode: data_free

substitute:
  arch: lenet_mnist
  init_seed: 1234
  trackA:
    batch_size: 128
    steps_coeff_c: 0.2
  optimizer:
    name: sgd
    lr: 0.01
    momentum: 0.9
    weight_decay: 5e-4
  loss:
    soft: kl
    hard: ce
  max_epochs: 1000
  patience: 100

attack:
  name: maze
  output_mode: soft_prob
  # MAZE params
  batch_size: 128
  n_g_steps: 1
  n_s_steps: 5
  n_r_steps: 10
  replay_max: 5000
  experience_replay: true
  output_channels: 1

budget:
  max_budget: 10000
  checkpoints: [1000, 10000]

cache:
  enabled: true
  policy: temporary
  delete_on_finish: true
